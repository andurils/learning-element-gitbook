# 2.8 å›¾è§£ npm scripts

> åŸæ–‡åœ°å€ï¼š [https://juejin.cn/post/6991347082552573965](https://juejin.cn/post/6991347082552573965)

æœ¬æ–‡å°†é€šè¿‡å›¾è§£çš„æ–¹å¼æ›´åŠ ç›´è§‚çš„è¯´æ˜å…¶å·¥ä½œæµï¼Œæ¶‰åŠåˆ°é¡¹ç›®æ„å»ºã€ä»£ç å¼€å‘ã€åˆ†æ”¯ç®¡ç†ã€è‡ªåŠ¨åŒ–æµ‹è¯•ã€æŒç»­é›†æˆã€é¡¹ç›®éƒ¨ç½²ã€æ€§èƒ½ç­‰ç›¸å…³å‘½ä»¤ã€å·¥ä½œæµç¨‹ã€ä¾èµ–æ–‡ä»¶ï¼Œè€å¿ƒè¯»å®Œï¼Œç›¸ä¿¡ä¼šå¯¹æ‚¨æœ‰æ‰€å¸®åŠ©ã€‚

## æ–‡ä»¶æ„å»º

### npm run i18n

æ‰§è¡Œ `node build/bin/i18n.js`ï¼ŒåŸºäº `examples/i18n/page.json` å„é¡µé¢åŠå›½é™…åŒ–é…ç½®ã€ `examples/pages/template` ç›®å½•ä¸‹çš„æ‰€æœ‰æ¨¡ç‰ˆæ–‡ä»¶ï¼Œåœ¨ç›®å½•`examples/pages/{lang}`ä¸‹ç”Ÿæˆ `zh-CN`ã€`en-US`ã€`es`ã€`fr-FR` ç­‰å››ç§è¯­è¨€çš„ç½‘ç«™.vue æ–‡ä»¶ã€‚

![image.png](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/0f5bb1ddd3454a9b9829a58c32e4f358\~tplv-k3u1fbpfcp-watermark.image)

### npm run build:file

æ‰§è¡Œå‘½ä»¤åï¼Œå¹¶è¡Œæ‰§è¡Œå¤šä¸ªä»»åŠ¡ç”Ÿæˆæ–‡ä»¶

æ‰§è¡Œ `node build/bin/iconInit.js` ï¼Œä½¿ç”¨  `postcss`  è§£æ  `packages/theme-chalk/src/icon.scss`ï¼Œæå–æ‰€æœ‰  `icon`  åå­—ç”Ÿæˆ  `examples/icon.json`  å›¾æ ‡é›†åˆæ–‡ä»¶ã€‚ `icon.json`  åœ¨å®˜ç½‘å…¥å£æ–‡ä»¶`examples\entry.js`  ä¸­å¯¼å…¥ï¼ŒæŒ‚è½½åˆ°  `Vue.prototype`ã€‚ ç”¨äº`Iconå›¾æ ‡`æ–‡æ¡£é¡µç”Ÿæˆæ‰€æœ‰çš„å›¾æ ‡é›†åˆ ã€‚

æ‰§è¡Œ `node build/bin/build-entry.js`ï¼ŒåŸºäºç»„ä»¶æ¸…å•æ–‡ä»¶`components.json`ç»“åˆå­—ç¬¦ä¸²æ¨¡ç‰ˆåº“`json-templater/string`è‡ªåŠ¨ç”Ÿæˆ `src/index.js` ç»„ä»¶åº“å…¥å£æ–‡ä»¶ã€‚

æ‰§è¡Œ `node build/bin/i18n.js` ç”Ÿæˆå®˜ç½‘çš„å¤šè¯­è¨€ç½‘ç«™æ–‡ä»¶,è¯¦è§å‘½ä»¤ `npm run i18n` ä»‹ç»ã€‚

æ‰§è¡Œ `node build/bin/version.js` è·å–`package.json`ä¸­ `version`ç‰ˆæœ¬å·ï¼Œ ç”Ÿæˆ `examples/version.json`é¡¹ç›®ç‰ˆæœ¬åˆ—è¡¨ä¿¡æ¯ï¼Œç”¨äºç½‘ç«™ç‰ˆå¤´éƒ¨å¯¼èˆªç‰ˆæœ¬åˆ‡æ¢ã€‚

![image.png](https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/2e6e923a8cf04e2f8620a433b670602c\~tplv-k3u1fbpfcp-watermark.image)

### npm run build:theme

ç”¨äºé¡¹ç›®çš„ä¸»é¢˜å’Œæ ·å¼ç”Ÿæˆã€‚

#### 1ï¸âƒ£ ç”Ÿæˆå…¥å£æ–‡ä»¶

`node build/bin/gen-cssfile` æ‰¾åˆ° `components.json`ï¼Œ è·å–ç»„ä»¶åˆ—è¡¨ï¼Œæ‰¾åˆ°`packages/theme-chalk/src`ç›®å½•ä¸‹å¯¹åº”çš„å„ç»„ä»¶çš„ `component-name.scss` æ–‡ä»¶ï¼Œä»¥`@import "./component-name.scss"`çš„å½¢å¼ï¼Œå†™å…¥`packages/theme-chalk/index.scss`æ–‡ä»¶-æ ·å¼æ€»å…¥å£æ–‡ä»¶ã€‚è‹¥æ˜¯ç»„ä»¶å¯¹åº”çš„æ ·å¼ä¸å­˜åœ¨ï¼Œä¼šè‡ªåŠ¨åˆ›å»ºé—æ¼çš„æ ·å¼æ–‡ä»¶ã€‚

#### 2ï¸âƒ£ æ„å»ºä¸»é¢˜

`gulp build --gulpfile packages/theme-chalk/gulpfile.js` ä¼šæ‰§è¡Œ `gulpfile.js` å®šä¹‰ä¸¤ä¸ªä»»åŠ¡(task):

* å°†`packages/theme-chalk/src`ç›®å½•ä¸‹çš„ scss æ–‡ä»¶è½¬æ¢æˆ css æ–‡ä»¶ï¼Œç»è¿‡æµè§ˆå™¨å…¼å®¹ã€å‹ç¼©å¤„ç†ï¼Œè¾“å‡ºè‡³`packages/theme-chalk/src/lib`ç›®å½•ä¸‹;
* å°†`packages/theme-chalk/src/fonts`ç›®å½•ä¸‹çš„å­—ä½“å›¾æ ‡æ–‡ä»¶å‹ç¼©å¤„ç†ï¼Œè¾“å‡ºè‡³ `packages/theme-chalk/src/lib/fonts` ç›®å½•ä¸‹ã€‚

#### 3ï¸âƒ£ æ‹·è´è‡³ lib/theme-chalk ä¸‹

é€šè¿‡`cp-cli`ï¼Œå°†`packages/theme-chalk/src/lib`ç›®å½•ä¸‹æ–‡ä»¶æ‹·è´è‡³`lib/theme-chalk`ç›®å½•ä¸‹ã€‚

![image.png](https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/aea93defb9214cc8ab39365357569e77\~tplv-k3u1fbpfcp-watermark.image)

### npm run build:utils

æŠŠ `src` ç›®å½•ä¸‹é™¤äº† `src/index.js`æ–‡ä»¶å¤–çš„å…¶ä»–æ–‡ä»¶é€šè¿‡ `babel` è½¬è¯‘åï¼Œè¾“å‡ºè‡³ `lib` æ–‡ä»¶å¤¹ä¸‹ã€‚

![image.png](https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/946a24996bfa4429814393631ffec6c0\~tplv-k3u1fbpfcp-watermark.image)

### npm run build:umd

æ‰§è¡Œ `node build/bin/build-locale.js` ,éå† `src/locale/lang` ç›®å½•ä¸‹æ‰€æœ‰ JS æ–‡ä»¶ï¼Œé€šè¿‡ `babel` è½¬è¯‘æˆ `umd` æ ¼å¼ï¼Œè¾“å‡ºè‡³ `lib/umd/locale` ç›®å½•ä¸‹ã€‚

![image.png](https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/2449e93c607c4ade8169aa26a7613b9b\~tplv-k3u1fbpfcp-watermark.image)

## å¼€å‘æ¨¡å¼

### npm run dev

é¦–å…ˆï¼Œæ‰§è¡Œå‘½ä»¤`npm run bootstrap` å®‰è£…é¡¹ç›®ä¾èµ–ï¼Œ åˆå§‹åŒ–å¼€å‘ç¯å¢ƒã€‚\
å…¶æ¬¡ï¼Œæ‰§è¡Œå‘½ä»¤`npm run build:file` æ„å»ºç½‘ç«™ç›¸å…³æ–‡ä»¶ï¼Œè¯¦è§ä¸Šæ–‡å‘½ä»¤ä»‹ç»ã€‚\
æœ€åï¼Œè¿è¡Œ`webpack-dev-server` æä¾›ä¸€ä¸ªæœ¬åœ°æœåŠ¡(serve) ï¼Œç¼–è¯‘è¿è¡Œé¡¹ç›®ç½‘ç«™(æ‰“åŒ…è§„åˆ™é…ç½® `build/webpack.demo.js`, æ¨¡å¼æ˜¯`development`ï¼Œå…¥å£æ–‡ä»¶æ˜¯`examples/entry.js`);åŒæ—¶æ‰§è¡Œ `node build/bin/template.js` æ–‡ä»¶å¯åŠ¨`chokidar`ç›‘å¬ `examples/pages/template` ç›®å½•ä¸‹æ¨¡æ¿æ–‡ä»¶ï¼Œè‹¥å†…å®¹å‘ç”Ÿå˜åŒ–ï¼Œæ‰§è¡Œå‘½ä»¤ `npm run i18n` é‡æ–°ç”Ÿæˆç½‘ç«™æ–‡ä»¶ã€‚

`webpack-dev-server` å…·æœ‰ `live reloading` åŠŸèƒ½,ç½‘ç«™æ–‡ä»¶å˜æ›´ä¼šé‡æ–°ç¼–è¯‘åŠ è½½ã€‚

![image.png](https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/36d4daea6355436aafbf5781e374b38d\~tplv-k3u1fbpfcp-watermark.image)

### npm run dev:play

é¦–å…ˆï¼Œæ‰§è¡Œå‘½ä»¤`npm run build:file` æ„å»ºç½‘ç«™ç›¸å…³æ–‡ä»¶ï¼Œè¯¦è§ä¸Šæ–‡å‘½ä»¤ä»‹ç»ã€‚\
å…¶æ¬¡ï¼Œè¿è¡Œ`webpack-dev-server` æä¾›ä¸€ä¸ªæœ¬åœ°æœåŠ¡(serve) ï¼Œç¼–è¯‘è¿è¡Œé¡¹ç›®ç½‘ç«™(æ‰“åŒ…è§„åˆ™é…ç½® `build/webpack.demo.js`)ã€‚

å‘½ä»¤ä¸­è®¾ç½®ç¯å¢ƒå˜é‡ `NODE_ENV=development PLAY_ENV=true`,æ‰“åŒ…å…¥å£æ–‡ä»¶ä¸º`examples/play.js`, è¯¥æ–‡ä»¶å¼•ç”¨ `examples/play/index.vue`, ç”¨äºç»„ä»¶åº“åŠŸèƒ½å±•ç¤ºã€‚

![image.png](https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/e2b0a7ac895040118e7c5a4f25c35a9e\~tplv-k3u1fbpfcp-watermark.image)

### npm run dev:extension

chorme æ’ä»¶é¡¹ç›®å¼€å‘è°ƒè¯• ,é¦–å…ˆ `rimraf examples/extension/dist` æ¸…é™¤é¡¹ç›®ä¸Šæ¬¡æ‰“åŒ…æ„å»ºå†…å®¹ï¼Œç„¶åä½¿ç”¨ `webpack` æ‰“åŒ…æ„å»ºé¡¹ç›®ï¼Œé…ç½®æ–‡ä»¶`build/webpack.extension.js`, å…¥å£æ–‡ä»¶ä¸º`examples/extension/src/background.js`å’Œ`examples/extension/src/entry.js`ã€‚ä½¿ç”¨ `watch` æ¨¡å¼,è‹¥å¼€å‘ä¸­æ–‡ä»¶å‘ç”Ÿå˜åŒ–ï¼Œåˆ™é‡æ–°æ‰“åŒ….

![image.png](https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/891751a16bd241fb8041c03beafd8fac\~tplv-k3u1fbpfcp-watermark.image)

## é¡¹ç›®æ„å»º

### npm run deploy:extension

ä¸å‘½ä»¤`npm run dev:extension`ç›¸ä¼¼ï¼Œä½¿ç”¨åŒä¸€æ‰“åŒ…é…ç½®æ–‡ä»¶ï¼Œç›¸åŒçš„å…¥å£æ–‡ä»¶ã€‚ä¸åŒä¹‹å¤„åŸºäº `production` æ¨¡å¼å¯¹åº”è§„åˆ™è¿›è¡Œæ‰“åŒ…,æ²¡æœ‰ä½¿ç”¨ `watch` æ¨¡å¼ã€‚

![image.png](https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/0b2c189210af40d7a21485ce345776ee\~tplv-k3u1fbpfcp-watermark.image)

### npm run deploy:build

é¦–å…ˆï¼Œæ‰§è¡Œå‘½ä»¤`npm run build:file` æ„å»ºç½‘ç«™ç›¸å…³æ–‡ä»¶ï¼Œè¯¦è§ä¸Šæ–‡å‘½ä»¤ä»‹ç»ã€‚\
å…¶æ¬¡ï¼Œæ‰§è¡Œ`webpack --config build/webpack.demo.js` åŸºäº production æ¨¡å¼ï¼Œæ‰“åŒ…ç”Ÿæˆå†…å®¹è¾“å‡ºè‡³ examples/element-ui/ç›®å½•ä¸‹ã€‚ æœ€åå°†é¡¹ç›®åŸŸå`element.eleme.io`å†™å…¥`examples/element-ui/CNAME` æ–‡ä»¶ä¸­ ã€‚

![image.png](https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/ed698989f828457eab000cb36a227200\~tplv-k3u1fbpfcp-watermark.image)

### npm run dist

* æ‰§è¡Œå‘½ä»¤`npm run clean`,æ¸…é™¤æ‰“åŒ…/æµ‹è¯•ç”Ÿæˆçš„ç›®å½•åŠæ–‡ä»¶;
* æ‰§è¡Œå‘½ä»¤`npm run build:file`,è¯¦è§ä¸Šæ–‡;
* æ‰§è¡Œå‘½ä»¤`npm run lint`,è¯¦è§ä¸Šæ–‡;
* æ‰§è¡Œæ‰“åŒ…`webpack --config build/webpack.conf.js`,å…¥å£æ–‡ä»¶ `src/index.js` ä»¥ `umd` æ ¼å¼è¾“å‡ºåˆ° `lib/index.js`;
* æ‰§è¡Œæ‰“åŒ…`webpack --config build/webpack.common.js`,å…¥å£æ–‡ä»¶ `src/index.js` ä»¥`commonjs2`æ ¼å¼è¾“å‡ºåˆ° `lib/element-ui.common.js`;
* æ‰§è¡Œæ‰“åŒ…`webpack --config build/webpack.component.js`,å…¥å£æ–‡ä»¶ `components.json`,å°†`packages`ç›®å½•ä¸‹çš„ç»„ä»¶ï¼Œä»¥`commonjs2`æ ¼å¼åˆ†åˆ«è¾“å‡ºåˆ°`lib`ç›®å½•,ç”¨äºæŒ‰éœ€å¼•å…¥;
* æ‰§è¡Œå‘½ä»¤`npm run build:utils` ,è¯¦è§ä¸Šæ–‡;
* æ‰§è¡Œå‘½ä»¤`npm run build:umd` ,è¯¦è§ä¸Šæ–‡;
* æ‰§è¡Œå‘½ä»¤`npm run build:theme`,è¯¦è§ä¸Šæ–‡ã€‚

![image.png](https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/c566919392d249c8962e6b50d17e4610\~tplv-k3u1fbpfcp-watermark.image)

### npm run pub

* æ‰§è¡Œå‘½ä»¤ npm run bootstrap,å®‰è£…ä¾èµ–ç¯å¢ƒ;
* è¿è¡Œ shell è„šæœ¬ sh build/git-release.sh ï¼Œæ£€æŸ¥ä»£ç  dev åˆ†æ”¯æ˜¯å¦å­˜åœ¨å†²çª(No conflicts);
* è¿è¡Œ shell è„šæœ¬ sh build/release.sh,åˆå¹¶ dev åˆ†æ”¯åˆ° master åˆ†æ”¯ã€æ›´æ–°ç‰ˆæœ¬å·ã€å‘å¸ƒä¸»é¢˜ã€push ä»£ç åˆ°è¿œç¨‹ä»“åº“ã€å‘å¸ƒç»„ä»¶åº“è‡³ NPM;
* æ‰§è¡Œæ–‡ä»¶ node build/bin/gen-indices.js,æä¾› algoliasearch æœç´¢åŠŸèƒ½ï¼Œéœ€è¦æŠŠ examples/docs ç›®å½•ä¸‹ .md æ–‡ä»¶å†…å®¹æ ¼å¼åŒ–åä¸Šä¼  algoliaã€‚

![image.png](https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/ad36334759274774a818281195ca2dc2\~tplv-k3u1fbpfcp-watermark.image)+

## make å‘½ä»¤

`Makefile` æ–‡ä»¶æè¿°äº†é¡¹ç›®çš„æ„å»ºè§„åˆ™ï¼Œå®ƒç”¨æ¥è‡ªåŠ¨åŒ–æ„å»ºé¡¹ç›®ã€‚ä¸€æ—¦å†™ç¼–å†™å¥½ Makefile æ–‡ä»¶ï¼Œåªéœ€è¦ä¸€ä¸ª make å‘½ä»¤(ä¹Ÿå¯ç›´æ¥æ‰§è¡Œå¯¹åº” npm script å‘½ä»¤)ï¼Œæ•´ä¸ªå·¥ç¨‹å°±å¼€å§‹è‡ªåŠ¨æ„å»ºã€‚ è¾“å…¥`make target`  å‘½ä»¤åï¼Œæ‰¾åˆ°  `target`  å¯¹åº”çš„  `commond` æ‰§è¡Œã€‚

![image.png](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/b10fe8bd9ce7475bbc46575d7f631c69\~tplv-k3u1fbpfcp-watermark.image)

## å…³è”é˜…è¯»

ç‚¹å‡»ä»¥ä¸‹é“¾æ¥ï¼Œå¯ä»¥å¿«é€ŸæŸ¥çœ‹æœ¬ç³»åˆ—å…¶ä»–æ–‡ç« ï¼š\
[ä¸“æ /Element 2.X æºç å­¦ä¹ ](https://juejin.cn/column/6961321064110489631)

ğŸ‘‡ é¡¹ç›®å·¥ç¨‹åŒ–ç³»åˆ—æ–‡ç« é“¾æ¥å¦‚ä¸‹ï¼Œæ¨èæŒ‰ç…§é¡ºåºé˜…è¯»æ–‡ç«  ğŸ‘‡ã€‚

1ï¸âƒ£ [æºç å‰–æä¹‹å·¥ç¨‹åŒ–ï¼šé¡¹ç›®æ¦‚è§ˆã€package.jsonã€npm script](https://juejin.cn/post/6969258163136626725)\
2ï¸âƒ£ [æºç å‰–æä¹‹å·¥ç¨‹åŒ–ï¼šé¡¹ç›®æ„å»ºã€MD è§£æ](https://juejin.cn/post/6969933702759940133)\
3ï¸âƒ£ [æºç å‰–æä¹‹å·¥ç¨‹åŒ–ï¼šæ‰“åŒ…é…ç½®](https://juejin.cn/post/6970691644114862111/)\
4ï¸âƒ£ [æºç å‰–æä¹‹å·¥ç¨‹åŒ–ï¼šå‘å¸ƒéƒ¨ç½²ã€æŒç»­é›†æˆ](https://juejin.cn/post/6971054455139598366/)\
5ï¸âƒ£ [æºç å‰–æä¹‹å·¥ç¨‹åŒ–ï¼šä¸»é¢˜æ„å»ºã€è‡ªåŠ¨åŒ–æµ‹è¯•ã€ä»£ç è´¨é‡æ£€æŸ¥ã€ç±»å‹å£°æ˜](https://juejin.cn/post/6971434343516340238)\
6ï¸âƒ£ [æºç å‰–æä¹‹å·¥ç¨‹åŒ–ï¼šé¡¹ç›®ç½‘ç«™](https://juejin.cn/post/6972180649625157645)\
7ï¸âƒ£ [æºç å‰–æä¹‹å·¥ç¨‹åŒ–ï¼šå‘½ä»¤ä¹‹å›¾è§£](https://juejin.cn/post/6991347082552573965)
