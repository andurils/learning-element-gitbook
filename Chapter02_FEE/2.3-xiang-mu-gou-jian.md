---
description: ğŸ“ build/
---

# 2.3 é¡¹ç›®æ„å»º

> åŸæ–‡åœ°å€ï¼š [https://juejin.cn/post/6969933702759940133](https://juejin.cn/post/6969933702759940133)

æœ¬æ–‡å°†ç»§ç»­æ·±å…¥ç ”ç©¶å·¥ç¨‹åŒ–æµç¨‹,å¯¹å‘½ä»¤ä¸­è°ƒç”¨çš„è„šæœ¬é…ç½®é€ä¸€åˆ†æã€‚

## components.json

`components.json`æ˜¯ä¸€ä»½é¡¹ç›®å®Œæ•´çš„ç»„ä»¶æ¸…å•ï¼Œåˆ—å‡ºäº†ç»„ä»¶çš„åç§°ã€æ–‡ä»¶è·¯å¾„ï¼Œåœ¨é¡¹ç›®æ–‡ä»¶æ„å»ºã€ webpack ç­‰å¤šå¤„ç”¨åˆ°ã€‚

`components.json`æ–‡ä»¶ä¸æ˜¯è‡ªåŠ¨ç”Ÿæˆçš„ï¼Œä½†å…¶æ¸…å•å†…å®¹æ˜¯è‡ªåŠ¨æ›´æ–°çš„ã€‚å½“ä½¿ç”¨ `make`å‘½ä»¤åˆ›å»ºæ–°ç»„ä»¶ package `make new <component-name> [ä¸­æ–‡å]` æ—¶è‡ªåŠ¨æ›´æ–°ç»„ä»¶æ¸…å•ï¼Œå…·ä½“å®ç°è¯¦è§ä¸‹æ–‡ `build/bin/new.js` åŠŸèƒ½è¯¦è§£ã€‚

![image.png](https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/dc7aa3a40975415183391067bba4942c\~tplv-k3u1fbpfcp-watermark.image)

## ğŸ”§ é¡¹ç›®æ„å»º build/bin

### build/bin/build-entry.js

ç”Ÿæˆç»„ä»¶åº“å…¥å£æ–‡ä»¶`src/index.js`ã€‚åŸºäºç»„ä»¶æ¸…å•æ–‡ä»¶`components.json`ç»“åˆå­—ç¬¦ä¸²æ¨¡ç‰ˆåº“`json-templater/string`è‡ªåŠ¨ç”Ÿæˆ ã€‚å½“ç»„ä»¶æ¸…å•å˜æ›´æ—¶å‹¿éœ€æ‰‹åŠ¨æ›´æ–°æ–‡ä»¶ï¼Œåªè¦è¿è¡Œè¯¥æ–‡ä»¶è‡ªåŠ¨ç”Ÿæˆæœ€æ–°æ–‡ä»¶è¦†ç›–æ›´æ–°ã€‚

![carbon (30).png](https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/0844ce36c74646dd962f016323b6340c\~tplv-k3u1fbpfcp-watermark.image)

### build/bin/build-locale.js

é€šè¿‡ babel å¤„ç† `src/locale/lang` ç›®å½•ä¸‹çš„ç¿»è¯‘æ–‡ä»¶ï¼Œç”Ÿæˆ `umd` æ ¼å¼æ–‡ä»¶ï¼Œè¾“å‡ºè‡³ `lib/umd/locale` ç›®å½•ä¸‹ã€‚

![carbon (31).png](https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/880ca8b250804afba7b3e6ebb2117b3b\~tplv-k3u1fbpfcp-watermark.image)

### build/bin/gen-cssfile.js

ç”Ÿæˆ `packages/theme-chalk/index.scss` æ ·å¼æ€»å…¥å£æ–‡ä»¶ã€‚å…¨é‡å¼•å…¥ç»„ä»¶æ—¶ï¼Œå¼•ç”¨æ”¹æ ·å¼å¦‚ä¸‹ `import 'packages/theme-chalk/src/index.scss'` ã€‚

![image.png](https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/d7bc95d9d2734522878ae1129dfb0691\~tplv-k3u1fbpfcp-watermark.image)

### build/bin/gen-indices.js

ä½¿ç”¨ `algoliasearch` è½»æ¾å®ç°æ–‡æ¡£å…¨ç«™æœç´¢ã€‚

![image.png](https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/57bcebda271548b48cb13ea504e595ef\~tplv-k3u1fbpfcp-watermark.image)

ä»¥`button`é¡µé¢ä¸ºä¾‹ï¼Œæå–åçš„é¡µé¢ç´¢å¼•å†…å®¹å¦‚ä¸‹ ğŸ‘‡ã€‚

![image.png](https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/81a1c7f54a5d4ce5b8df7a2755794b63\~tplv-k3u1fbpfcp-watermark.image)

### build/bin/i18n.js

ç”¨äºé¡¹ç›®å®˜ç½‘çš„å›½é™…åŒ–ã€‚åŸºäº `examples/i18n/page.json` å›½é™…åŒ–é…ç½®å’Œ `examples/pages/template` ç›®å½•ä¸‹çš„æ‰€æœ‰æ¨¡ç‰ˆæ–‡ä»¶ï¼Œç”Ÿæˆ `zh-CN`ã€`en-US`ã€`es`ã€`fr-FR`ç­‰å››ç§è¯­è¨€çš„`.vue`æ–‡ä»¶ã€‚

![carbon (86).png](https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/adb905b22fd544bfb3352bb62e1c53fd\~tplv-k3u1fbpfcp-watermark.image)

### build/bin/iconInit.js

ä½¿ç”¨ `postcss` è§£æ `icon.scss`ï¼Œæå–æ‰€æœ‰ `icon` åå­—ç”Ÿæˆ `examples/icon.json` æ–‡ä»¶ã€‚

![carbon (32).png](https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/5dab4c64518f4e56a594df036d38d9e6\~tplv-k3u1fbpfcp-watermark.image)

`icon.json` åœ¨å®˜ç½‘å…¥å£æ–‡ä»¶`examples\entry.js` ä¸­å¯¼å…¥ï¼ŒæŒ‚è½½åˆ° `Vue.prototype`ã€‚ ç”¨äº`Iconå›¾æ ‡`æ–‡æ¡£é¡µç”Ÿæˆæ‰€æœ‰çš„å›¾æ ‡é›†åˆï¼Œè¯¦è§ä¸‹å›¾ ğŸ‘‡ã€‚

```
import icon from './icon.json';
Vue.prototype.$icon = icon; // Icon åˆ—è¡¨é¡µç”¨
```

![image.png](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/56f1d7f362e144919297e05a292107c2\~tplv-k3u1fbpfcp-watermark.image)

### build/bin/new-lang.js

ä¸ºç½‘ç«™æ·»åŠ æ–°è¯­è¨€ã€‚ä¾‹å¦‚ 'make new-lang fr' ï¼Œæ·»åŠ æ–°è¯­è¨€é…ç½®è‡³ `components.json`ã€`page.json`ã€`route.json`ã€`nav.config.json`ç­‰æ–‡ä»¶ä¸­ï¼Œé…ç½®é»˜è®¤å¤åˆ¶`en-US`è¯­è¨€è®¾ç½®ï¼Œæ–°å»ºå¯¹åº”æ–‡ä»¶å¤¹ `examples/docs/fr`ã€‚

![carbon (33).png](https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/50e5bbed333d440fa165eb383397b4b4\~tplv-k3u1fbpfcp-watermark.image)

### build/bin/new.js

åˆ›å»ºæ–°ç»„ä»¶ packageï¼Œè‡ªåŠ¨åˆ›å»ºç»„ä»¶ç›¸å…³æ–‡ä»¶å’Œåˆå§‹ç»„ä»¶çš„å…¨å±€é…ç½®ä¿¡æ¯ã€‚ ä¾‹å¦‚ 'make new button æŒ‰é’®',æ­¥éª¤å¦‚ä¸‹ï¼š

1. åˆ›å»ºçš„æ–°ç»„ä»¶æ·»åŠ è‡³ç»„ä»¶æ¸…å•`components.json`ä¸­ã€‚
2. ä¸»é¢˜æ ·å¼å…¥å£æ–‡ä»¶`packages/theme-chalk/src/index.scss`æ·»åŠ ç»„ä»¶å¯¼å…¥è¯­å¥ã€‚
3. åœ¨ `types/element-ui.d.ts` è‡ªåŠ¨å¼•å…¥æ–°ç»„ä»¶ç±»å‹å£°æ˜ã€‚
4. åˆ›å»º package :\
   åˆ›å»ºç»„ä»¶æ–‡ä»¶ `packages/button/index.js` `packages/button/src/main.vue`\
   åˆ›å»ºå¤šè¯­è¨€ç»„ä»¶æ–‡æ¡£ `examples/docs/{lang}/button.md`\
   åˆ›å»ºå•å…ƒæµ‹è¯•æ–‡ä»¶ `test/unit/specs/button.spec.js`\
   åˆ›å»ºç»„ä»¶æ ·å¼æ–‡ä»¶ `packages/theme-chalk/src/button.scss`\
   åˆ›å»ºç»„ä»¶ç±»å‹å£°æ˜æ–‡ä»¶ `types/button.d.ts`
5. æ›´æ–° nav.config.jsonï¼Œæ·»åŠ æ–°ç»„ä»¶å¯¼èˆªä¿¡æ¯ï¼ˆç»„ä»¶èœå•ä¸‹å·¦ä¾§çš„äºŒçº§å¯¼èˆªï¼‰

![image.png](https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/82f11af5cf2c48149c9be74a2c0e6b44\~tplv-k3u1fbpfcp-watermark.image)

> ğŸš¨ è‹¥é¡¹ç›®ç½‘ç«™å¢åŠ äº†æ–°äº†è¯­è¨€ï¼Œéœ€è¦åœ¨ Files æ•°ç»„æ·»åŠ é…ç½®ç¡¬ç¼–ç æŒ‡å®šè¯­è¨€ã€‚
>
> <img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/d76aaeb9f11e4e479b6f60f595d868db~tplv-k3u1fbpfcp-watermark.image" alt="image.png" data-size="original">

### build/bin/template.js

ç”¨äºç›‘å¬`examples/pages/template`ç›®å½•ä¸‹æ¨¡æ¿æ–‡ä»¶æ˜¯å¦å‘ç”Ÿæ”¹å˜ï¼Œè‹¥å­˜åœ¨å˜åŒ–ä¼šè‡ªåŠ¨æ‰§è¡Œå‘½ä»¤`npm run i18n`ï¼Œè¿è¡Œæ–‡ä»¶`build/bin/i18n.js`ï¼Œé‡æ–°ç”Ÿæˆç½‘ç«™æ–‡ä»¶ã€‚

![image.png](https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/4bbaa1e1a1d1443b8935ba3f5e095b0f\~tplv-k3u1fbpfcp-watermark.image)

### build/bin/version.js

ç”Ÿæˆ `examples/version.json` è®°å½•é¡¹ç›®åº“ç‰ˆæœ¬ä¿¡æ¯ã€‚

![image.png](https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/80439736e0234a3f8cbba431c01e15c2\~tplv-k3u1fbpfcp-watermark.image)

**process.env.VERSION å‚æ•°çš„æ˜¯æ€ä¹ˆä¼ å…¥çš„ï¼Ÿ**

å½“æ‰§è¡Œå‘½ä»¤ `npm run pub` å‘å¸ƒç»„ä»¶åº“æ—¶ï¼Œä¼šæ‰§è¡Œè„šæœ¬ `build/release.sh`ï¼Œä¼šæ‰‹åŠ¨è¾“å…¥å‘å¸ƒæœ¬ä¿¡æ¯(`read -p "Releasing $VERSION - are you sure? (y/n)" -n 1 -r`),ç„¶åæ‰§è¡Œå‘½ä»¤ `VERSION=$VERSION npm run dist`ã€‚

æ•´ä¸ªæ‰§è¡Œé¡ºåº ğŸ‘‰ `npm run pub`=>`sh build/release.sh`=>`è¾“å…¥$VERSION`=>`VERSION=$VERSION npm run dist`=> `npm run build:file`=> `node build/bin/version.js` ã€‚

ç”¨äºç½‘ç«™ç‰ˆå¤´éƒ¨å¯¼èˆªç‰ˆæœ¬åˆ‡æ¢ ğŸ‘‡ã€‚

![image.png](https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/a1ac360528ef4c9ea8c1250b32521df2\~tplv-k3u1fbpfcp-watermark.image)

## ğŸ”„ .MD è§£æè½¬æ¢ build/md-loader

`webpack` ä½¿ç”¨è‡ªå®šä¹‰çš„ `markdown-loder`å¯¹æ–‡ä»¶è¿›è¡Œå¤„ç†ï¼Œå°† `ç»„ä»¶æ–‡æ¡£.md` ç¼–è¯‘ä¸º HTMLã€‚å·²åœ¨å‰æ–‡ [04.å°è£…ç»„ä»¶å°è£…ã€ç¼–å†™è¯´æ˜æ–‡æ¡£](https://juejin.cn/post/6953614014546968589#heading-5) ä¸­è¯¦ç»†è¯´æ˜,ä¸å†è¿‡å¤šèµ˜è¿°ã€‚

## å…³è”é˜…è¯»

ç‚¹å‡»ä»¥ä¸‹é“¾æ¥ï¼Œå¯ä»¥å¿«é€ŸæŸ¥çœ‹æœ¬ç³»åˆ—å…¶ä»–æ–‡ç« ï¼š\
[ä¸“æ /Element 2.X æºç å­¦ä¹ ](https://juejin.cn/column/6961321064110489631)

ğŸ‘‡ é¡¹ç›®å·¥ç¨‹åŒ–ç³»åˆ—æ–‡ç« é“¾æ¥å¦‚ä¸‹ï¼Œæ¨èæŒ‰ç…§é¡ºåºé˜…è¯»æ–‡ç«  ğŸ‘‡ã€‚

1ï¸âƒ£ [æºç å‰–æä¹‹å·¥ç¨‹åŒ–ï¼šé¡¹ç›®æ¦‚è§ˆã€package.jsonã€npm script](https://juejin.cn/post/6969258163136626725)\
2ï¸âƒ£ [æºç å‰–æä¹‹å·¥ç¨‹åŒ–ï¼šé¡¹ç›®æ„å»ºã€MD è§£æ](https://juejin.cn/post/6969933702759940133)\
3ï¸âƒ£ [æºç å‰–æä¹‹å·¥ç¨‹åŒ–ï¼šæ‰“åŒ…é…ç½®](https://juejin.cn/post/6970691644114862111/)\
4ï¸âƒ£ [æºç å‰–æä¹‹å·¥ç¨‹åŒ–ï¼šå‘å¸ƒéƒ¨ç½²ã€æŒç»­é›†æˆ](https://juejin.cn/post/6971054455139598366/)\
5ï¸âƒ£ [æºç å‰–æä¹‹å·¥ç¨‹åŒ–ï¼šä¸»é¢˜æ„å»ºã€è‡ªåŠ¨åŒ–æµ‹è¯•ã€ä»£ç è´¨é‡æ£€æŸ¥ã€ç±»å‹å£°æ˜](https://juejin.cn/post/6971434343516340238)\
6ï¸âƒ£ [æºç å‰–æä¹‹å·¥ç¨‹åŒ–ï¼šé¡¹ç›®ç½‘ç«™](https://juejin.cn/post/6972180649625157645)\
7ï¸âƒ£ [æºç å‰–æä¹‹å·¥ç¨‹åŒ–ï¼šå‘½ä»¤ä¹‹å›¾è§£](https://juejin.cn/post/6991347082552573965)
